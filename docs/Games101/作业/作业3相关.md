# GAMES101 作业3相关问题整理

---

## 问题1：C++17 环境下 std::optional 和 std::nullopt 无法识别

### 问题
编译时提示 `optional` 类型无法识别，编译器表示 std 里没有 `optional` 类，同时也提示 `nullopt` 识别不了。

### 解决思路
`optional` 和 `nullopt` 是 C++17 标准新增的类和关键字，低版本编译器不支持。

### 解决方法
将代码 IDE 环境的 C++ 标准更新到 C++17 及以上。例如在 VS2017 中，设置方法为：  
调试 -> 属性 -> C++ -> 语言 -> 语言标准。

**参考：**  
[Games101 作业3 环境问题 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/371207541)

---

## 问题2：interpolated_shadingcoords 的含义

### 问题
不清楚 `interpolated_shadingcoords` 的具体含义。

### 解决思路
插值后得到的坐标是着色点的真实空间坐标。光栅化时只知道像素坐标 (x, y)，通过深度插值得到 screen space 的 (x, y, z)。但这不是 camera space 的真实点，需要用重心坐标结合 `viewspace_pos` 插值得到 camera space 的着色点。

### 解决方法
利用 alpha、beta、gamma 重心坐标和 `viewspace_pos` 插值，得到 camera space 的着色点（即 `interpolated_shadingcoords`）。  
这个点用于后续的 Blinn-Phong 反射模型计算，比如着色点到光源的距离 r，以及光线方向 l。

**注意：**  
重心坐标本质上需要矫正才能用于 3D 空间插值，但实际误差不大，通常直接使用。

**参考：**  
[GAMES101作业3-代码过程详细理解_games101代码解读-CSDN博客](https://blog.csdn.net/qq_41835314/article/details/124666935)

---

## 问题3：深度插值为何要做权重（透视校正插值）

### 问题
深度插值为什么需要做权重？即透视校正插值的原因。

### 解决思路
由于投影矩阵将视锥压缩为长方体，插值时需要进行透视校正，否则会产生误差。

### 解决方法
插值时对重心坐标进行透视校正，确保插值结果在 3D 空间中准确。

**参考：**  
[《GAMES101》作业框架问题详解 - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/509902950)
